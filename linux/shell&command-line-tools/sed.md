sed行式处理流编辑器

---

    sed 选项 '命令' 文件名  #命令行格式 
    sed -f 脚本文件 文件名  #脚本格式

sed 中使用变量例如`$var`， 使用单引号包含双引号方式： `'"$var"'`

sed常用选项

- -e或--expression=脚本  指定用以处理文件的脚本内容
- -f或--file=脚本文件  指定用以处理文件的脚本文件
- -i或--in-place[=SUFFIX] 编辑文件内容并取代原文件
- -n或--quiet或--silent 仅显示处理后的结果
- -l或--line-length=N   指定换行期望长度
- -r或-regexp-extended  启用扩展的正则表达式
- -u或–unbuffered  从输入文件中加载最少的数据，并更频繁的刷出到输出缓冲区
- -z或–null-data  使用NULL字符分割行（默认每一行使用换行符分割）

sed常用命令

- 行打印   p 
  注意，使用sed 'p' filename会将文件内容每行打印两次，配合-n则可只打印一次。
- 替换  s  替换匹配项 格式s/old/new/
  全局替换使用g：s/old/new/g
- 写入 w   写入文件指定内容到另一个文件中（使用sed 选项 '指定内容 w 目标文件名' 文件名)
- 多个命令 {comand1;command2}  （引号写在括号之外）

行定位 ：在行定位命令后紧邻写上各种操作命令

- 单行
  - $  最后一行
  - 数字  n  第n行
  - 正则  /pattern/   匹配该正则的那行
- 多行
  - 数字  m,n  第m到n行
  - 数字和正则混合  /pattern/,n和n,/pattern/
  - 正则  /pattern1/,/pattern2/
  - n!  取反，除了第n行  m,n!
  - 间隔行n~x  从第n行开始每隔x行

行编辑

- 新增
  - a  在匹配项的下一行新增内容
  - i   在匹配项的上一行新增内容
- 替换  c  替换匹配项所在行
- 删除  d  删除匹配的内容
- 多行
  - N  将数据流中的下一行加进来创建一个多行组来处理
  - D  删除多行组中的一行
  - P  打印多行组中的一行

保持空间

用于临时保存一些行。

- h  将模式空间复制到保持空间
- H  将模式空间附加到保持空间
- g  将保持空间复制到模式空间
- G  将保持空间附加到模式空间
- x  交换模式空间和保持空间的内容

示例：

    sed  -n '2p' file  #打印第2行
    sed -i '1,5a ===' test  #在test文件第1到5行每行的下面添加一行===
    sed -i '1~2d' test  #在test文件中从第一行开始删除，每隔2行删除一次（一行）
    ip addr | grep -o -E '1[^2][0-9?](\.[0-9]{1,3}){3}\/' -o | sed 's/\///'  #本机内网地址
    sed -n '1 w newfile' originfile  #将originfile文件第一行内容写入到newfile文件中



